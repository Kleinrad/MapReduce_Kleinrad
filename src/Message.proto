syntax = "proto3";

package mapreduce;

enum MessageType {
    WORKER_ASSIGNMENT = 0;
    WORKER_SIGN_OFF = 1;
    TASK_MAP = 2;
    TASK_REDUCE = 3;
    RESULT_MAP = 4;
    RESULT_REDUCE = 5;
    CONFIRM = 6;
    JOB_REQUEST = 7;
    JOB_RESULT = 8;
}

message WorkerAssignment{
    MessageType type = 1;
    int32 worker_id = 2;
}

message WorkerSignOff{
    MessageType type = 1;
    int32 worker_id = 2;
}

message TaskMap{
    MessageType type = 1;
    string data = 2;
}

message TaskReduce{
    MessageType type = 1;
    int32 key = 2;
    repeated string values = 3;
}

message ResultMap{
    MessageType type = 1;
    int32 key = 2;
    string value = 3;
}

message ResultReduce{
    MessageType type = 1;
    int32 key = 2;
    string value = 3;
}

message Confirm{
    MessageType type = 1;
    int32 worker_id = 2;
}

message JobRequest{
    MessageType type = 1;
    int32 job_id = 2;
    string data = 3;
    int32 num_mappers = 4;
    int32 num_reducers = 5;
}

message JobResult{
    MessageType type = 1;
    int32 job_id = 2;
    string data = 3;
}